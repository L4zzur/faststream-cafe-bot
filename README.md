# FastStream Cafe üê∞‚òïÔ∏è

<p align="center">
  <img src="docs/assets/avatar.png" alt="FastStream Cafe Avatar" width="200"/>
</p>

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –æ—Å–≤–æ–µ–Ω–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–∞ –±–∞–∑–µ **RabbitMQ** –∏ **FastStream**.
–ü—Ä–æ–µ–∫—Ç –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –∫–æ—Ñ–µ–π–Ω–∏: –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è "–≥–æ—Ç–æ–≤–∫–∞" –≤ –≤–æ—Ä–∫–µ—Ä–µ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞—á–∞–ª–µ –≥–æ—Ç–æ–≤–∫–∏ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–∞.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤:

1.  **Cashier** (`FastAPI` + `FastStream`): HTTP API –¥–ª—è –ø—Ä–∏—ë–º–∞ –∑–∞–∫–∞–∑–æ–≤. –ü—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ RabbitMQ.
2.  **Kitchen** (`FastAPI` + `FastStream`): –í–æ—Ä–∫–µ—Ä (Consumer), –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å, "–≥–æ—Ç–æ–≤–∏—Ç" –∑–∞–∫–∞–∑ (–∏–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏) –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Å—Ç–∞—Ç—É—Å—ã (`started`, `processed`).
3.  **Bot** (`aiogram` + `FastStream`): –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–∫–∞–∑—ã –≤ API –∏ —Å–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
4.  **Shared**: –û–±—â–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å –º–æ–¥–µ–ª—è–º–∏ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ª–æ–≥–≥–µ—Ä–∞ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏ –æ—á–µ—Ä–µ–¥–µ–π –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

## –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã

```mermaid
sequenceDiagram
    actor User as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant Bot as ü§ñ Telegram Bot
    participant Cashier as üíµ Cashier API
    participant RMQ as üêá RabbitMQ
    participant Kitchen as üë®‚Äçüç≥ Kitchen

    User->>Bot: 1. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    Bot->>Cashier: 2. POST /orders
    activate Cashier
    Cashier->>RMQ: 3. –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ order.created
    Cashier-->>Bot: 200 OK
    deactivate Cashier
    Bot-->>User: –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç

    RMQ->>Kitchen: 4. –ü–æ–ª—É—á–µ–Ω–æ order.created
    activate Kitchen
    Kitchen->>RMQ: 5. –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ order.started
    RMQ->>Bot: –ü–æ–ª—É—á–µ–Ω–æ order.started
    Bot-->>User: üç≥ –ó–∞–∫–∞–∑ –ø–æ–ª—É—á–µ–Ω –∏ –≥–æ—Ç–æ–≤–∏—Ç—Å—è

    Note over Kitchen: –ò–º–∏—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∫–∏...

    Kitchen->>RMQ: 6. –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ order.processed
    deactivate Kitchen

    RMQ->>Bot: –ü–æ–ª—É—á–µ–Ω–æ order.processed
    Bot-->>User: –ó–∞–∫–∞–∑ –≥–æ—Ç–æ–≤!
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](docs/architecture.md)
- [–°–µ—Ä–≤–∏—Å Bot](bot/README.md)
- [–°–µ—Ä–≤–∏—Å Cashier](cashier/README.md)
- [–°–µ—Ä–≤–∏—Å Kitchen](kitchen/README.md)
- [–ú–æ–¥—É–ª—å Shared](shared/README.md)

## –°—Ç–µ–∫

- **Python 3.13**
- **RabbitMQ 3**
- **FastAPI**
- **FastStream[rabbit]**
- **aiogram 3**
- **Docker** –∏ **Docker Compose**

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

   ```bash
   git clone https://github.com/L4zzur/faststream-cafe-bot.git
   cd faststream-cafe-bot
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏—Å–ø–æ–ª—å–∑—É—è `.env.example`:
     ```bash
     cp .env.example .env
     ```
   - –û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ —É–∫–∞–∂–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:
     ```env
     BOT_TOKEN=YOUR_BOT_TOKEN_HERE
     ```
   - –ü–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ç–∞–∫ –∂–µ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤.

3. **–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose:**

   ```bash
   docker-compose up -d --build
   ```

4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram.
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start`.
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã, –¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ –æ—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑.
   - –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –≤ —á–∞—Ç–µ –∏ –ª–æ–≥–∞–º–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ!
